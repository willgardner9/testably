"use strict";
!(function () {
  var t, e;
  const o = (document.cookie && document.cookie.split("; ")) || !1,
    i = "bcff9d7b-886a-43fd-92a4-41b2db0ede63",
    d = "b97001dd-89c8-41e4-b575-cdebdd05e318",
    n = "http://127.0.0.1:5500/embed-script/demo/index.html",
    a = "http://127.0.0.1:5500/embed-script/demo/pricing.html",
    s = document.querySelector("h2"),
    c = {
      "f1ff73ae-149f-43a3-8bf8-c5dc73ae5df4": "Privacy-friendly A/B testing",
      "86a92a88-4d61-42e9-a460-89c22daecf54": "No-code A/B testing",
    };
  const r = (function () {
      var t;
      let e =
        (o &&
          (null === (t = o.find((t) => t.startsWith("testably_variation="))) ||
          void 0 === t
            ? void 0
            : t.split("=")[1])) ||
        !1;
      return (
        (e && c[e]) ||
          ((e =
            Object.keys(c)[
              Math.floor(Math.random() * Object.keys(c).length)
            ].toString()),
          (document.cookie = `testably_variation=${e};max-age=2592000`)),
        e
      );
    })(),
    l = window.location.href,
    f =
      (o &&
        (null === (t = o.find((t) => t.startsWith("testably_visited="))) ||
        void 0 === t
          ? void 0
          : t.split("=")[1])) ||
      !1,
    p =
      (o &&
        (null === (e = o.find((t) => t.startsWith("testably_converted="))) ||
        void 0 === e
          ? void 0
          : e.split("=")[1])) ||
      !1;
  function h() {
    p ||
      ((document.cookie = "testably_converted=true;max-age=2592000"),
      fetch("http://127.0.0.1:3333/api/v1/conversions", {
        method: "post",
        mode: "cors",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({userId: i, testId: d, variationId: r}),
      }));
  }
  (l !== n && l !== a) ||
    (l !== n ||
      f ||
      ((document.cookie = "testably_visited=true;max-age=2592000"),
      fetch("http://127.0.0.1:3333/api/v1/sessions", {
        method: "post",
        mode: "cors",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({userId: i, testId: d, variationId: r}),
      })),
    l === n && ((s.textContent = c[r]), (s.value = c[r])),
    l === a && f && h(),
    window.addEventListener("popstate", function (t) {
      console.log("detected url change to:", window.location.href);
    }));
})();
