"use strict";
!(function () {
  var t;
  const e = (document.cookie && document.cookie.split("; ")) || !1,
    o = "bcff9d7b-886a-43fd-92a4-41b2db0ede63",
    n = "b97001dd-89c8-41e4-b575-cdebdd05e318",
    i = "http://127.0.0.1:5500/embed-script/demo/index.html",
    d = "http://127.0.0.1:5500/embed-script/demo/pricing.html",
    a = document.querySelector("h2"),
    c = {
      "f1ff73ae-149f-43a3-8bf8-c5dc73ae5df4": "Privacy-friendly A/B testing",
      "86a92a88-4d61-42e9-a460-89c22daecf54": "No-code A/B testing",
    };
  const s = (function () {
      var t;
      let o =
        (e &&
          (null === (t = e.find((t) => t.startsWith("testably_variation="))) ||
          void 0 === t
            ? void 0
            : t.split("=")[1])) ||
        !1;
      return (
        (o && c[o]) ||
          ((o =
            Object.keys(c)[
              Math.floor(Math.random() * Object.keys(c).length)
            ].toString()),
          (document.cookie = "testably_variation=" + o + ";max-age=2592000")),
        o
      );
    })(),
    r = window.location.href,
    l =
      (e &&
        (null === (t = e.find((t) => t.startsWith("testably_converted="))) ||
        void 0 === t
          ? void 0
          : t.split("=")[1])) ||
      !1;
  function f() {
    l ||
      ((document.cookie = "testably_converted=true;max-age=2592000"),
      fetch("http://127.0.0.1:3333/api/v1/conversions", {
        method: "post",
        mode: "cors",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({userId: o, testId: n, variationId: s}),
      }));
  }
  (r !== i && r !== d) ||
    (r === i &&
      ((a.textContent = c[s]),
      (a.value = c[s]),
      fetch("http://127.0.0.1:3333/api/v1/sessions", {
        method: "post",
        mode: "cors",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({userId: o, testId: n, variationId: s}),
      })),
    r === d && s && f(),
    window.addEventListener("popstate", function (t) {
      console.log("detected url change to:", window.location.href);
    }));
})();
